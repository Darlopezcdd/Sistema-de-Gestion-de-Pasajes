
CREATE TABLE RUTAS (
    ID_RUTA NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRE_RUTA VARCHAR2(100) NOT NULL,
    ORIGEN VARCHAR2(50) NOT NULL,
    DESTINO VARCHAR2(50) NOT NULL,
    DISTANCIA_KM NUMBER(5,2),
    PRECIO_BASE NUMBER(10,2) DEFAULT 0 NOT NULL CHECK (PRECIO_BASE >= 0),
    ESTADO VARCHAR2(1) DEFAULT 'A' CHECK (ESTADO IN ('A', 'I')) 
);

CREATE TABLE UNIDADES (
    ID_UNIDAD NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PLACA VARCHAR2(10) NOT NULL UNIQUE,
    NOMBRE_UNIDAD VARCHAR2(50) NOT NULL,
    CAPACIDAD NUMBER(3) NOT NULL,
    MODELO VARCHAR2(50),
    ESTADO VARCHAR2(1) DEFAULT 'A' CHECK (ESTADO IN ('A', 'I'))
);

CREATE TABLE TIPOS_PASAJE (
    ID_TIPO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DESCRIPCION VARCHAR2(50) NOT NULL,
    PORCENTAJE_DESCUENTO NUMBER(5,2) DEFAULT 0 CHECK (PORCENTAJE_DESCUENTO >= 0 AND PORCENTAJE_DESCUENTO <= 100)
);


CREATE TABLE PASAJES (
    ID_PASAJE NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_RUTA NUMBER NOT NULL,
    ID_UNIDAD NUMBER NOT NULL,
    ID_TIPO NUMBER NOT NULL,
    FECHA_VIAJE DATE NOT NULL,
    CANTIDAD_ASIENTOS NUMBER(2) DEFAULT 1 NOT NULL CHECK (CANTIDAD_ASIENTOS > 0),
    VALOR NUMBER(10,2) NOT NULL CHECK (VALOR >= 0),
    FECHA_EMISION TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT FK_RUTA FOREIGN KEY (ID_RUTA) REFERENCES RUTAS(ID_RUTA),
    CONSTRAINT FK_UNIDAD FOREIGN KEY (ID_UNIDAD) REFERENCES UNIDADES(ID_UNIDAD),
    CONSTRAINT FK_TIPO FOREIGN KEY (ID_TIPO) REFERENCES TIPOS_PASAJE(ID_TIPO)
);

INSERT INTO RUTAS (NOMBRE_RUTA, ORIGEN, DESTINO, DISTANCIA_KM, PRECIO_BASE) VALUES ('Ruta Costa', 'Guayaquil', 'Salinas', 140.5, 5.00);
INSERT INTO RUTAS (NOMBRE_RUTA, ORIGEN, DESTINO, DISTANCIA_KM, PRECIO_BASE) VALUES ('Ruta Sierra', 'Quito', 'Ambato', 150.0, 7.50);

INSERT INTO UNIDADES (PLACA, NOMBRE_UNIDAD, CAPACIDAD, MODELO) VALUES ('GBA-1234', 'Unidad 01', 40, 'Hino GH');
INSERT INTO UNIDADES (PLACA, NOMBRE_UNIDAD, CAPACIDAD, MODELO) VALUES ('PBA-5678', 'Unidad 02', 45, 'Mercedes Benz');

INSERT INTO TIPOS_PASAJE (DESCRIPCION, PORCENTAJE_DESCUENTO) VALUES ('Normal', 0);
INSERT INTO TIPOS_PASAJE (DESCRIPCION, PORCENTAJE_DESCUENTO) VALUES ('Tercera Edad', 50);
INSERT INTO TIPOS_PASAJE (DESCRIPCION, PORCENTAJE_DESCUENTO) VALUES ('Estudiantil', 50);

COMMIT;
